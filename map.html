
    <!DOCTYPE html>
<html>
<head>
    <title>Simple Map</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        #map { height: 80vh; }
        .leaflet-popup-content {
            font-size: 14px; /* スマートフォンに適した文字サイズ */
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Tabletop.js/1.6.3/tabletop.min.js"></script>

    <script>
        var spreadsheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS5mI-mFXcTG3D_p80YuDZSGiPotbyIogRxhnl2BcnAyLEISwnVq44d9BMZ5GT76JtrcO_LoVipix9l/pubhtml'; // 公開されたスプレッドシートのURL

        // スプレッドシートからデータを読み込むための関数
        function loadDataFromSpreadsheet() {
            Tabletop.init({
                key: spreadsheetUrl,
                callback: displayDataOnMap,
                simpleSheet: true
            });
        }

        // データを地図上に表示する関数
        function displayDataOnMap(data) {
            var map = L.map('map').setView([35.6895, 139.6917], 13); // 東京の座標をデフォルトに設定

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);

            data.forEach(function(item) {
                var marker = L.marker([item.緯度, item.経度]).addTo(map);
                marker.bindPopup('<b>' + item.案件名称 + '</b><br><a href="' + item.案件報告用URL + '" target="_blank">報告フォーム</a><br><a href="' + item.画像1 + '" target="_blank">画像1</a><br><a href="' + item.画像2 + '" target="_blank">画像2</a>');
            });

            map.locate({setView: true, maxZoom: 16});
            map.on('locationfound', onLocationFound);
            map.on('locationerror', onLocationError);

            function onLocationFound(e) {
                var radius = e.accuracy / 2;
                var locationMarker = L.circleMarker(e.latlng, {
                    radius: 8,
                    fillColor: "#ff7800",
                    color: "#000",
                    weight: 1,
                    opacity: 1,
                    fillOpacity: 0.8
                }).addTo(map);
                locationMarker.bindPopup("現在地").openPopup();
            }

            function onLocationError(e) {
                alert(e.message);
            }
        }

        // ページが読み込まれた時にデータを読み込む
        window.addEventListener('load', loadDataFromSpreadsheet);
    </script>
</body>
</html>

    
